---
name: react-performance
description: Reactアプリのパフォーマンス最適化の判断フロー。memo化、レンダリング最適化を検討する場面で使用する。
---

# パフォーマンス最適化ガイドライン

## 大原則

**計測なき最適化は行わない。**

## 最適化の判断フロー

### Step 1: 問題を計測する
- React DevTools Profilerでレンダリング頻度と所要時間を確認する
- 体感できる遅延がなければ、最適化は不要

### Step 2: 原因を特定する
- 不要な再レンダリングが起きているか？
- 重い計算がレンダー中に実行されているか？
- 大量のDOM更新が発生しているか？

### Step 3: 適切な手法を選ぶ

| 原因 | 対策 |
|------|------|
| 親の再レンダリングで子が不要に再描画 | `React.memo` でメモ化 |
| propsとして渡す関数が毎回再生成 | `useCallback` で安定化 |
| レンダー中の重い計算 | `useMemo` でキャッシュ |
| 大量リストの描画 | 仮想化ライブラリ（react-window等）を検討 |

### Step 4: 効果を確認する
- 最適化後に再度Profilerで計測する
- 改善が見られなければ最適化コードを削除する（不要な複雑さを避ける）

## やってはいけないこと
- Profilerで確認せずにmemo化を適用する
- すべてのコンポーネントに一律でReact.memoをかける
- useMemo/useCallbackを「とりあえず」使う